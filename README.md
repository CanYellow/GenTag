# GenTag说明

这是一个使用 ahk2.0 脚本写的从csv文件选择零件名与附图标记的小工具。制作这个小工具的本意主要是方便撰写专利申请文件时正确地插入附图标记。

## 使用说明

### 运行与退出

只需要在进行文字录入时，打开 GenTag.exe, 使之保持在状态栏运行即可。如果要退出  GenTag.exe，需要在状态栏图标上右键退出。

### 数据准备

软件需要从一个 csv 文件中获取数据，因此软件打开时会自动打开文件选择窗口，需要在该窗口下指定一份记录了 零件名与附图标记的 csv 文件作为输入。软件运行时，可以根据 csv 文件的更新自动更新内容。

csv文件的示例如下:

```
#tp,实用新型
#ti,专利名称
#thf,主题名称1
#ths,主题名称2
1,零件一
1S,标记1
11,零件二
12,零件三
112,零件四
```

### 用法示例

软件的默认快捷键是 `\`

1. 由于`\`被软件占用，如果需要输入原义的`\`，可以通过按下`Ctrl + Shift + \`组合键上屏。
2. `\`默认弹出候选窗，如果没有配置csv文件，会先弹出文件选择窗口。
3. csv 文件必须使用 utf-8 带签名(BOM) 的格式，否则输出内容可能乱码。
4. 候选框下回车是直接关闭候选，回到原来的窗口。
5. 候选框下，在输入框内输入标号，下面的候选列表会自动刷新匹配的清单，通过输入的最后一个字符确定上屏格式(在输入超过两字符时起作用)。
6. 数据上屏经反复考虑是通过剪贴板实现的，这是能力范围内能实现的最稳定、速度最好、兼容性最好的方案了。具体见后。
7. 为了避免误上屏，要求除最后一个字符外的输入的所有字符与 csv 文件里的标记存在唯一完全匹配时上屏，也就是说部分匹配时是不会有内容上屏的。

以上面的csv文件中的数据为例，其中最后字符与上屏格式的对应关系为

  任意非空内容+a：`1：零件一；11：零件二；112：零件四；12：零件三；1S：标记1。`；
  
  匹配标号+b（比如`1b`）：`零件一1`；
  
  匹配标号+c（比如`1b`）：`零件一(1)`；
  
  匹配标号+n（比如`11n`）：`零件二`；
  
  同上，匹配标号+n（比如`#thfn`）：`主题名称1`；
  
  匹配标号+v（比如`112v`）：`112`；


## 其他说明

使用剪贴板上屏是目前比较好的方式，如果直接发送数据消息，会受到所使用的输入法的干扰，导致上屏内容出错。另一方面，如果直接发送数据消息， Word中是单个字符依次录入的，反应太慢，且时间不可控。